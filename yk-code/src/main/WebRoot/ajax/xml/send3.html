<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>send.html</title>	
    <meta http-equiv="content-type" content="text/html; charset=gb2312">
<script type="text/javascript">
<!--
var xmlhttp=null;
 function createXMLHttpRequest()
    {
    	var objxmlhttp=null;
    	var xmlhttpTypes=["Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.6.0"];
    	if(window.ActiveXObject)
    		{
    		for(var i=0;i<xmlhttpTypes.length;i++)
    		{
    			try{
    					objxmlhttp=new ActiveXObject(xmlhttpTypes[i]);
    					break;
    			   }catch(e){continue;}
    		}
    	}
    	else if(window.XMLHttpRequest)
    	{
    		objxmlhttp=new XMLHttpRequest();
    	}
    	return objxmlhttp;
    }	
    function send()
    {
		xmlhttp=createXMLHttpRequest();
    	if(xmlhttp==null)
    	{
    		alert("你的浏览器不支持Ajax!!!");
    	}
    	else{
			xmlhttp.onreadystatechange=show;
    			var URL="book.xml";
    			xmlhttp.open("GET",URL,true);
    			xmlhttp.send(null);
    	    }
    }
    function show()
    {	 
	    	if(xmlhttp.readyState==4 )
	    	{		
			if(xmlhttp.status==200 || xmlhttp.status==0)
			{
			    var xmldoc=xmlhttp.responseXML;    	
				var xmldisplay=document.getElementById("xmldisplay");
				var display=xmldoc.getElementsByTagName("display");
				xmldisplay.innerHTML="";
				var table=document.createElement("table");
				/*
				table.setAttribute("width", "600");
				table.setAttribute("border", "1");
				table.setAttribute("bordercolor", "#000000");
				table.setAttribute("cellspacing", "0");
				table.setAttribute("cellspadding", "0");
				table.setAttribute("id", "tab");
				*/
				for(var i=0;i<display.length;i++)
				{	
					var Row=table.insertRow(i);
					for(var j=0;j<display[i].childNodes.length;j++)
					{
						var data=display[i].childNodes[j].firstChild.data;
						var Cell=Row.insertCell(j);
						table.rows[i].cells[j].innerHTML=data;
					}	
				}
				xmldisplay.appendChild(table);
				//changtabborderstyle();	
			}
			
	    	}		
    }
    function changtabborderstyle()
    {
    	 var tab=document.getElementById("tab");
    	 tab.style.borderCollapse="collapse";
    }
-->

</script>
  </head>
  
  <body>
  <div align="center">
   <input type="button" value="请求数据" onclick="send()">
   <div id="xmldisplay"></div>
   </div>
  </body>
</html>


