<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>send.html</title>	
    <meta http-equiv="content-type" content="text/html; charset=gb2312">
<script type="text/javascript">
<!--
var xmlhttp=null;
 function createXMLHttpRequest()
    {
    	var objxmlhttp=null;
    	var xmlhttpTypes=["Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.6.0"];
    	if(window.ActiveXObject)
    		{
    		for(var i=0;i<xmlhttpTypes.length;i++)
    		{
    			try{
    					objxmlhttp=new ActiveXObject(xmlhttpTypes[i]);
    					break;
    			   }catch(e){continue;}
    		}
    	}
    	else if(window.XMLHttpRequest)
    	{
    		objxmlhttp=new XMLHttpRequest();
    	}
    	return objxmlhttp;
    }	
    function send()
    {
		xmlhttp=createXMLHttpRequest();
    	if(xmlhttp==null)
    	{
    		alert("你的浏览器不支持Ajax!!!");
    	}
    	else{
			xmlhttp.onreadystatechange=show;
    			var URL="dealxml.jsp";
    			xmlhttp.open("GET",URL,true);
    			xmlhttp.send(null);
    	    }
    }
    function show()
    {	 
	    	if(xmlhttp.readyState==4 )
	    	{		
			if(xmlhttp.status==200 || xmlhttp.status==0)
			{
			    var xmldoc=xmlhttp.responseXML;  	
				var xmldisplay=document.getElementById("xmldisplay");
				xmldisplay.innerHTML="";
				var table=document.createElement("table");
				table.setAttribute("width", "600");
				table.setAttribute("border", "1");
				table.setAttribute("borderColor", "#000000");
				table.setAttribute("cellSpacing", "0");
				table.setAttribute("cellPadding", "0");
				table.setAttribute("id", "tab");
				var display=xmldoc.getElementsByTagName("dispaly");
				for(var i=0;i<display.length;i++)
				{
				/*
					var tr=document.createElement("tr");
					var ISBN=display[i].getElementsByTagName("ISBN")[0].firstChild.data;
					var name=display[i].getElementsByTagName("name")[0].firstChild.data;
					var publisher=display[i].getElementsByTagName("publisher")[0].firstChild.data;
					var price=display[i].getElementsByTagName("price")[0].firstChild.data;
					var num=display[i].getElementsByTagName("num")[0].firstChild.data;
					var td_ISBN=document.createElement("td");
					td_ISBN.appendChild(document.createTextNode(ISBN));
					var td_name=document.createElement("td");
					td_name.appendChild(document.createTextNode(name));
					var td_publisher=document.createElement("td");
					td_publisher.appendChild(document.createTextNode(publisher));
					var td_price=document.createElement("td");
					td_price.appendChild(document.createTextNode(price));
					var td_num=document.createElement("td");
					td_num.appendChild(document.createTextNode(num));
					tr.appendChild(td_ISBN);
					tr.appendChild(td_name);
					tr.appendChild(td_publisher);
					tr.appendChild(td_price);
					tr.appendChild(td_num);
					table.appendChild(tr);	
				*/
				
				}
				xmldisplay.appendChild(table);
				changtabborderstyle();
				
			}
			
	    	}		
    }
    function changtabborderstyle()
    {
    	 var tab=document.getElementById("tab");
    	 tab.style.borderCollapse="collapse";
    }
-->

</script>
  </head>
  
  <body>
  <div align="center">
   <input type="button" value="请求数据" onclick="send()">
   <div id="xmldisplay"></div>
   </div>
  </body>
</html>

